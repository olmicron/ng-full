# Домашнее задание к занятию 12.7. «Репликация и масштабирование. Часть 2»

### Инструкция по выполнению домашнего задания

1. Сделайте fork [репозитория c шаблоном решения](https://github.com/netology-code/sys-pattern-homework) к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/gitlab-hw или https://github.com/имя-вашего-репозитория/8-03-hw).
2. Выполните клонирование этого репозитория к себе на ПК с помощью команды `git clone`.
3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
   - впишите вверху название занятия и ваши фамилию и имя;
   - в каждом задании добавьте решение в требуемом виде: текст/код/скриншоты/ссылка;
   - для корректного добавления скриншотов воспользуйтесь инструкцией [«Как вставить скриншот в шаблон с решением»](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md);
   - при оформлении используйте возможности языка разметки md. Коротко об этом можно посмотреть в [инструкции по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md).
4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`).
5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
6. Любые вопросы задавайте в чате учебной группы и/или в разделе «Вопросы по заданию» в личном кабинете.

Желаем успехов в выполнении домашнего задания.

---

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;
- активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);
- SAN-кластер.

*Дайте ответ в свободной форме.*

#### Ответ

> активный master-сервер и пассивный репликационный slave-сервер

Преимущество в том, чо у нас будет актуальная копия БД, которая сможет принять на себя нагрузку (стать мастером) в случае отказа мастера.

> master-сервер и несколько slave-серверов

Тоже что и в первом случае, только тут ещё повышение производительности, т.к. в мастер пишем, а читаем из слэйв серверов, т.о. нагрузка на чтение распределяется между серверами.

> активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD)

Это мы не проходили, это нам не задавали. Парам-пам-пам :)

В лекции вскользь упоминалось DRDB без описания того, что это такое. Мне кажется мы раньше это проходили, но вообще не помню уже. Но предположу, что это виртуальные (или физические) диски распараллеленные на разные ноды, и доступные как единое устройство через сеть. Т.о. храня данные из БД (в данном случае), эти данные будут доступны по единому интерфейсу и при этом они же реплицируются и мы, по сути ничего не делая, получаем отказоустойчивость на уровне данных. 

> SAN-кластер

Опять же, в лекции это упоминалось вскользь, без подробностей. Но исходя из данных в лекции, предположу, что это аналог DRDB, но подключается к машине как блочное устройство, соответственно те же.

П.С. Не гуглил ни SAN, ни DRDB, т.к. всё равно пока не начну пользоваться - не запомню. Просто буду знать что есть такое и что связано с хранением данных, а когда понадобится - тогда уже буду разбираться.

---

### Задание 2

Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.*

#### Ответ

Я не буду описывать или придумывать содержимое таблиц, просто опишу как бы я сделал исходя из полученной из лекции информации. И вместо блок-схемы опишу что бы я сделал, словами.

1. Таблица пользователей - допустим в ней есть емайл и авторизация по емайлу. Тогда я бы вертикально шардировал табблицу по первым двум символам емайла, чтобы ускорить работу поиска пользователя по емайлу. Вообще, я бы вынес это в отдельную БД, возможно на отдельный сервер, или ноду (VPS, или даже контейнер и т.п.) с отдельным микросервисом для доступа к процессу авторизации...

2. Книги - сделал бы так же вертикальное шардирование по названиям книг. Также, я бы возможно добавил здесь горизонтальное шардирование (репликация), и даже если данные на разных серверах будут в какой-то момент рассинхронизированы - тут это не столь важно и данные обновляются не часто (какую-либо статистику в расчет не берём, т.к. для этого лучше использовать отдельную БД).

3. Магазины - тут я бы скорее всего не делал вертикальное шардирование, разве что по именам магазинов... А сделал бы горизонтальное шардирование (или как оно правильно называется в данном случае), но не с репликацией всех данных, а разделение на локацию. Например, магазины в Москве будут в БД которая на серверах в Москве, БД по магазинам в Питере я бы также разместил на серверах в Питере... Небольшие города я бы разместил в одной БД в одной локации с вертикальным шарингом по городам. Т.о. БД с магазинами не зависят между собой, магазины с Питере никак не зависят и не пересекаются с магазинами в Москве.   


## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

---
### Задание 3*

Выполните настройку выбранных методов шардинга из задания 2.

*Пришлите конфиг Docker и SQL скрипт с командами для базы данных*.
